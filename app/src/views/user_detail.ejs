<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="/css/user_detail.css">
    <title>UserPage</title>
 
</head>
<body>
    <%- include('nav.ejs') %>
    <div class="userdetail_con mt-4">
    <form action="/userpage" method="POST">
        <fieldset>
            <legend>userpage</legend>
            <h1><%= user.id %> 님의 페이지입니다.</h1>
            <div class="form-floating mb-3">
                <label for="floatingInput">이메일 : <%= user.email%></label>
              </div>
              <div class="form-floating mb-3">
                <label for="birthday">생년월일</label>
                <select id="year" class="form-select" name="year">
                  <option selected><%= user.birthday.year%>년</option>
                  <% for (let i = new Date().getFullYear(); i >= 1900; i--) { %>
                    <option value="<%= i %>"><%= i %>년</option>
                  <% } %>
                </select>
                <select id="month" class="form-select" name="month">
                  <option selected><%= user.birthday.month%>월</option>
                  <% for (let i = 1; i <= 12; i++) { %>
                    <option value="<%= i %>"><%= i %>월</option>
                  <% } %>
                </select>
                <select id="day" class="form-select" name="day">
                  <option selected><%= user.birthday.day%>일</option>
                  <% for (let i = 1; i <= 31; i++) { %>
                    <option value="<%= i %>"><%= i %>일</option>
                  <% } %>
                </select>
              </div>
              <div class="col-md-12">
                <label for="inputState" class="form-label">성별</label>
                <select id="inputState1" class="form-select" id="genderSelect" name="gender">
                  <option value="men" <%= user.gender === 'men' ? 'selected' : '' %>>남자</option>
                  <option value="women" <%= user.gender === 'women' ? 'selected' : '' %>>여자</option>
                </select>
              </div>
              <div class="col-md-12">
                <label for="inputState" class="form-label">국가</label>
                <select id="inputState2" class="form-select" id="countrySelect" name="country">
                  <option value="Korea" <%= user.country === 'Korea' ? 'selected' : '' %>>대한민국</option>
                  <option value="USA" <%= user.country === 'USA' ? 'selected' : '' %>>미국</option>
                  <option value="France" <%= user.country === 'France' ? 'selected' : '' %>>프랑스</option>
                  <option value="UK" <%= user.country === 'UK' ? 'selected' : '' %>>영국</option>
                </select>
              </div>  
              <div class="row mb-3">
                    <label class="form-check-label" for="gridCheck1" name="isOptedIn">
                    <span><a href="/privacypolicy" target="_blank" style="color: red;">개인정보처리방침</a></span>에 따른 개인정보 수집 및 활용에 동의하였습니다.  
                    </label>
              </div> 
              <div class="row mb-3">
                <div class="col-sm-10">
                  <div class="form-check">
                    <% if(user.isOptedIn==='off'){ %>
                    <input class="form-check-input" type="radio" id="gridCheck2" value="on" name="isOptedIn">
                     <label for="floatingInput"> gunchimfilx 특별 할인 알림 이메일을 받고싶어요</label><br/>
                     <% } else { %>
                     <input class="form-check-input" type="radio" id="gridCheck2" value="off" name="isOptedIn">
                    <label for="floatingInput">gunchimfilx 특별 할인 알림 이메일을 받고싶지 않아요 </label>
                    <% } %>
                  </div>
                </div>
              </div>
            </fieldset>
            <div class="row mt-3">
              <div class="col-sm-6">
                <button type="submit" id="updateuser" class="btn btn-primary">회원정보수정</button>
                <button type="button" id="removeuser" class="btn btn-danger" >회원탈퇴</button>
              </div>
          </div>
        </form>

        <!-- <form action="/" method="GET">
          <button type="submit" id="logout"><a href="/logout">로그아웃</button>
        </form> -->
    </div>
    <%- include('footer.ejs') %>
</body>
<script>
document.getElementById("removeuser").addEventListener("click", (event) => {
  const confirmed = confirm("계정을 삭제하시겠습니까?");
  if (confirmed) {
    window.location.href = "/userpage/delete?confirmed=true";
  } else {
    event.preventDefault();
  }
});
</script>
</html>